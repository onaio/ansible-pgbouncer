pgbouncer_version: "1.13.*"

reload_not_restart: False
ignore_startup_parameters:

# TLS mode to use for connections to PostgreSQL servers. Supported values:
#
# disable: Plain TCP. TCP is not even requested from the server. Default.
# prefer: TLS connection is always requested first from PostgreSQL, when refused connection will be established over plain TCP. Server certificate is not validated.
# require: Connection must go over TLS. If server rejects it, plain TCP is not attempted. Server certificate is not validated.
# verify-ca: Connection must go over TLS and server certificate must be valid according to server_tls_ca_file. Server host name is not checked against certificate.
# verify-full: Connection must go over TLS and server certificate must be valid according to server_tls_ca_file. Server host name must match certificate information. 
pgbouncer_server_tls_sslmode: "verify-ca"

# Contents of the TLS CA certificate the PostgreSQL database's certificate is signed using.
pgbouncer_server_tls_ca_content: "{{ lookup('url', 'https://s3.amazonaws.com/rds-downloads/rds-ca-2019-root.pem', split_lines=false) }}"

# Whether to install the apt repository with PgBouncer
pgbouncer_install_repository: true
pgbouncer_apt_key_id: "ACCC4CF8"
pgbouncer_apt_key_url: "https://www.postgresql.org/media/keys/{{ pgbouncer_apt_key_id }}.asc"
# Version of the PostgreSQL apt repository
pgbouncer_apt_postgresql_version: 12
pgbouncer_apt_repository: "deb http://apt.postgresql.org/pub/repos/apt/ {{ ansible_distribution_release }}-pgdg main {{ pgbouncer_apt_postgresql_version }}"

pgbouncer_listen_addr: 127.0.0.1
pgbouncer_listen_port: 6432

pgbouncer_enable_client_tls: false
pgbouncer_client_tls_sslmode: require
pgbouncer_client_tls_ca_file: /var/lib/postgresql/pgbouncer-root.crt
pgbouncer_client_tls_key_file: /var/lib/postgresql/pgbouncer.key
pgbouncer_client_tls_cert_file: /var/lib/postgresql/pgbouncer.crt
pgbouncer_client_tls_ciphers: normal